---
title: "Tugas 1 MPDW"
author: "Anna Maria (G1401231025)"
date: "2025-09-01"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(forecast)
library(graphics)
library(TTR)
library(TSA)
library(ggplot2)
library(rio)
```
## Impor Data
```{r}
gold <- import("https://raw.githubusercontent.com/mriannaa/MPDW/refs/heads/main/Pertemuan%201/Gold%20Price_Anna.csv")
gold
```

## Eksplorasi Data
```{r}
str(gold) #Untuk melihat struktur data
dim(gold) #Untuk melihat dimensi data
```


```{r}
gold.ts <- ts(gold$Price) #Mengubah Data menjadi Data Deret Waktu, agar terbaca oleh R
```

```{r}
summary(gold.ts) #Menunjukan ringkasan data
```
### Plot Deret Waktu
```{r}
#Untuk melihat Plot Deret Waktu
ts.plot(gold.ts, xlab="Time Period ", ylab="Reading", 
        main = "Time Series Plot")
points(gold.ts)
```
#### Grafik plot deret waktu menunjukkan adanya pola tren, ditandai dengan pergerakan data yang berubah secara bertahap seiring waktu, bukan bersifat acak maupun musiman.

## Single Moving Average & Double Moving Average
### Pembagian Data
#### Perbandingan data latih sebesar 80% dan data uji 20%
```{r}
#Untuk membagi data latih dan data uji
training_ma <- gold[1:80,]
testing_ma <- gold[81:100,]
train_ma.ts <- ts(training_ma$Price)
test_ma.ts <- ts(testing_ma$Price)
```
## Eksplorasi Data Testing dan Data Uji
```{r}
#eksplorasi keseluruhan data
plot(gold.ts, col="red",main="Plot semua data")
points(gold.ts)
```

```{r}
plot(train_ma.ts, col="blue",main="Plot data latih")
points(train_ma.ts)
```

```{r}
#eksplorasi data uji
plot(test_ma.ts, col="blue",main="Plot data uji")
points(test_ma.ts)
```
```{r}
ggplot() + 
  geom_line(data = training_ma, aes(x = Date, y = Price, col = "Data Latih")) +
  geom_line(data = testing_ma, aes(x = Date, y = Price, col = "Data Uji")) +
  labs(x = "Date", y = "Price", color = "Legend") +
  scale_colour_manual(name="Keterangan:", breaks = c("Data Latih", "Data Uji"),
                      values = c("blue", "red")) + 
  theme_bw() + theme(legend.position = "bottom",
                     plot.caption = element_text(hjust=0.5, size=12))
```

## Pemulusan Data

### Double Moving Average (DMA)
```{r}
data.sma<-SMA(train_ma.ts, n=4)
data.sma
```

```{r}
dma <- SMA(data.sma, n = 4)
At <- 2*data.sma - dma
Bt <- 2/(4-1)*(data.sma - dma)
data.dma<- At+Bt
data.ramal2<- c(NA, data.dma)

t = 1:24
f = c()

for (i in t) {
  f[i] = At[length(At)] + Bt[length(Bt)]*(i)
}

data.gab2 <- cbind(aktual = c(train_ma.ts,rep(NA,24)), pemulusan1 = c(data.sma,rep(NA,24)),pemulusan2 = c(data.dma, rep(NA,24)),At = c(At, rep(NA,24)), Bt = c(Bt,rep(NA,24)),ramalan = c(data.ramal2, f[-1]))
data.gab2
```

```{r}
#Visualisasi Data Hasil Pemulusan DMA
ts.plot(gold.ts, xlab="Time Period ", ylab="Price", main= "DMA N=4 Data Price")
points(gold.ts)
lines(data.gab2[,3],col="green",lwd=2)
lines(data.gab2[,6],col="red",lwd=2)
legend("topleft",c("data aktual","data pemulusan","data peramalan"), lty=6, col=c("black","green","red"), cex=0.8)
```

### Perhitungan akurasi SSE, MSE, dan MAPE
```{r}
#Menghitung nilai keakuratan data latih
error_train.dma = train_ma.ts-data.ramal2[1:length(train_ma.ts)]
SSE_train.dma = sum(error_train.dma[8:length(train_ma.ts)]^2)
MSE_train.dma = mean(error_train.dma[8:length(train_ma.ts)]^2)
MAPE_train.dma = mean(abs((error_train.dma[8:length(train_ma.ts)]/train_ma.ts[8:length(train_ma.ts)])*100))

akurasi_train.dma <- matrix(c(SSE_train.dma, MSE_train.dma, MAPE_train.dma))
row.names(akurasi_train.dma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_train.dma) <- c("Akurasi m = 4")
akurasi_train.dma
```

#### Nilai MAPE pada data latih menunjukan angka 6% yang masih berada di bawah 10%. Hal ini menunjukan bahwa nilai akurasi data latih masih sangat baik.
```{r}
#Menghitung nilai keakuratan data uji
error_test.dma = test_ma.ts-data.gab2[81:100,6] 
SSE_test.dma = sum(error_test.dma^2)
MSE_test.dma = mean(error_test.dma^2)
MAPE_test.dma = mean(abs((error_test.dma/test_ma.ts*100)))

akurasi_test.dma <- matrix(c(SSE_test.dma, MSE_test.dma, MAPE_test.dma))
row.names(akurasi_test.dma)<- c("SSE", "MSE", "MAPE")
colnames(akurasi_test.dma) <- c("Akurasi m = 4")
akurasi_test.dma
```

#### Disini, pada perhitungan data uji menunjukan nilai MAPE sebesar 3% yang masih di bawah 10%. Hal ini menunjukan bahwa nilai akurasi data uji masih sangat baik.

## Single Exponential Smoothing & Double Exponential Smoothing

### Pembagian Data latih 80% dan Data uji 20%
```{r}
#membagi training dan testing
training<-gold[1:80,]
testing<-gold[81:100,]
train.ts <- ts(training$Price)
test.ts <- ts(testing$Price)
```

### Eksplorasi
```{r}
plot(gold.ts, col="black",main="Plot semua data")
points(gold.ts)
```

```{r}
plot(train.ts, col="red",main="Plot data latih")
points(train.ts)
```

```{r}
plot(test.ts, col="blue",main="Plot data uji")
points(test.ts)
```

```{r}
#Eksplorasi dengan GGPLOT
library(ggplot2)
ggplot() + 
  geom_line(data = training, aes(x = Date, y = Price, col = "Data Latih")) +
  geom_line(data = testing, aes(x = Date, y = Price, col = "Data Uji")) +
  labs(x = "Periode Waktu", y = "Membaca", color = "Legend") +
  scale_colour_manual(name="Keterangan:", breaks = c("Data Latih", "Data Uji"),
                      values = c("blue", "red")) + 
  theme_bw() + theme(legend.position = "bottom",
                     plot.caption = element_text(hjust=0.5, size=12))
```


### SES

```{r}
#Cara 1 (fungsi ses)
ses.1 <- ses(train.ts, h = 10, alpha = 0.2)
plot(ses.1)
```

```{r}
ses.1
```
```{r}
ses.2<- ses(train.ts, h = 10, alpha = 0.7)
plot(ses.2)
```

```{r}
ses.2
```
#### Visualisasi hasil pemulusan pada data latih
```{r}
autoplot(ses.1) +
  autolayer(fitted(ses.1), series="Fitted") +
  ylab("Membaca") + xlab("Periode")
```
#### Hasil forecasting dengan SES menunjukkan bahwa nilai akan cenderung stabil di sekitar 60.000, dengan ketidakpastian yang meningkat pada periode mendatang.

```{r}
#Cara 2 (fungsi Holtwinter)
ses1<- HoltWinters(train.ts, gamma = FALSE, beta = FALSE, alpha = 0.2)
plot(ses1)
```

```{r}
#ramalan
ramalan1<- forecast(ses1, h=20)
ramalan1
```
```{r}
ses2<- HoltWinters(train.ts, gamma = FALSE, beta = FALSE, alpha = 0.7)
plot(ses2)
```

```{r}
#ramalan
ramalan2<- forecast(ses2, h=20)
ramalan2
```

```{r}
#SES
ses.opt <- ses(train.ts, h = 20, alpha = NULL)
plot(ses.opt)
```

```{r}
#Lamda Optimum Holt Winter
HWopt<- HoltWinters(train.ts, gamma = FALSE, beta = FALSE,alpha = NULL)
plot(HWopt)
```

```{r}
#ramalan
ramalanopt<- forecast(HWopt, h=20)
ramalanopt
```
#### Selanjutnya akan dilakukan perhitungan keakuratan hasil peramalan, baik pada data latih dan data uji.

```{r}
accuracy(ramalanopt,testing$Price)
```
#### Pada perhitungan akurasi menunjukan data latih nilai MAPE sebesar 0.55% dan data uji sebesar 0.49% yang masih di bawah 10%. Hal ini menunjukan bahwa nilai akurasi data latih dan data uji sangat baik.

## DES
```{r}
#Lamda=0.2 dan gamma=0.2
des.1<- HoltWinters(train.ts, gamma = FALSE, beta = 0.2, alpha = 0.2)
plot(des.1)
```

```{r}
#ramalan
ramalandes1<- forecast(des.1, h=20)
ramalandes1
```

```{r}
#Lamda=0.6 dan gamma=0.3
des.2<- HoltWinters(train.ts, gamma = FALSE, beta = 0.3, alpha = 0.6)
plot(des.2)
```

```{r}
#ramalan
ramalandes2<- forecast(des.2, h=20)
ramalandes2
```

```{r}
#Visualisasi
plot(data1.ts)
lines(des.1$fitted[,1], lty=2, col="blue")
lines(ramalandes1$mean, col="red")
```
#### Untuk mendapatkan nilai parameter optimum dari DES, argumen alpha dan beta dapat dibuat NULL seperti berikut.

```{r}
#Lamda dan gamma optimum
des.opt<- HoltWinters(train.ts, gamma = FALSE)
des.opt
```

```{r}
plot(des.opt)
```

```{r}
#ramalan
ramalandesopt<- forecast(des.opt, h=20)
ramalandesopt
```

```{r}
accuracy(ramalandesopt,testing$Price)
```
#### Pada perhitungan akurasi menunjukan data latih nilai MAPE sebesar 0.56% dan data uji sebesar 0.55% yang masih di bawah 10%. Hal ini menunjukan bahwa nilai akurasi data latih dan data uji sangat baik.

## Perbandingan SES dan DES
```{r}
MSEfull <-
  matrix(c(MSEtesting1,MSEtesting2,MSEtestingopt,MSEtestingdes1,MSEtestingdes2,
           MSEtestingdesopt),nrow=3,ncol=2)
row.names(MSEfull)<- c("ske 1", "ske 2", "ske opt")
colnames(MSEfull) <- c("ses","des")
MSEfull
```

